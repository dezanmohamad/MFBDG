<!doctype html>
<html lang="id" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Muslim Footballers Bandung</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Inter:wght@400;500;600;700&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
  
  <style>
    body { box-sizing: border-box; font-family: 'Inter', sans-serif; }
    .font-arabic { font-family: 'Amiri', serif; }
    .font-head { font-family: 'Oswald', sans-serif; }
    
    .glass-effect { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(218, 165, 32, 0.2); }
    .glass-nav { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
    
    .gold-gradient { background: linear-gradient(135deg, #DAA520 0%, #FFD700 100%); }
    .platinum-gradient { background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); border: 1px solid #475569; }
    
    .hover-lift { transition: all 0.3s ease; }
    .hover-lift:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(218, 165, 32, 0.3); }
    
    /* Menu Styles Revised */
    .menu-item { 
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
        cursor: pointer; 
        position: relative;
        overflow: hidden;
    }
    .menu-item:hover { background-color: rgba(218, 165, 32, 0.1); }
    
    /* Active State: Platinum Style */
    .menu-item.active { 
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%); 
        color: white; 
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(15, 23, 42, 0.2);
        border: 1px solid rgba(218, 165, 32, 0.3);
    }
    
    /* Gold Accent for Active Item */
    .menu-item.active::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 3px;
        background: linear-gradient(90deg, #DAA520, #FFD700);
    }
    
    .islamic-pattern { 
        background-color: #fdfbf7;
        background-image: radial-gradient(#DAA520 0.5px, transparent 0.5px), radial-gradient(#DAA520 0.5px, #fdfbf7 0.5px);
        background-size: 20px 20px;
        background-position: 0 0, 10px 10px;
    }

    /* Badge W-D-L */
    .badge-win { background-color: #22c55e; color: white; }
    .badge-draw { background-color: #9ca3af; color: white; }
    .badge-loss { background-color: #ef4444; color: white; }
    
    /* LOGIKA ADMIN */
    .admin-only { display: none !important; }
    body.is-admin .admin-only { display: block !important; }
    body.is-admin div.flex.admin-only { display: flex !important; } 
    body.is-admin label.admin-only { display: flex !important; }

    .admin-toggle { 
        position: fixed; 
        bottom: 30px; 
        left: 30px; 
        z-index: 99999; 
        font-size: 24px; 
        cursor: pointer; 
        background: linear-gradient(135deg, #DAA520 0%, #FFD700 100%); 
        width: 60px; 
        height: 60px; 
        border-radius: 50%; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        box-shadow: 0 4px 12px rgba(0,0,0,0.3); 
        transition: all 0.3s ease; 
        border: 3px solid white; 
    }
    .admin-toggle:hover { transform: scale(1.1) rotate(15deg); }
    
    /* Toast Notification */
    .toast { animation: fadeIn 0.3s, fadeOut 0.3s 2.5s forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeOut { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-20px); } }
    
    /* Hide Scrollbar but keep functionality */
    .hide-scrollbar::-webkit-scrollbar { display: none; }
    .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
 </head>
 <body class="h-full islamic-pattern text-slate-800">
  <div id="app" class="h-full w-full overflow-auto">
   
   <!-- HEADER WITH SEARCH -->
   <header class="glass-effect shadow-sm sticky top-0 z-50 border-b border-amber-100/50">
    <div class="max-w-7xl mx-auto px-4 py-3 md:py-4">
     <div class="flex items-center justify-between gap-4">
      <div class="flex items-center gap-3 flex-shrink-0">
        <div class="w-10 h-10 bg-gradient-to-br from-slate-800 to-slate-900 rounded-full flex items-center justify-center text-white text-xl shadow-lg border-2 border-amber-400">âš½</div>
        <div class="hidden md:block">
           <h1 id="appTitle" class="text-lg md:text-2xl font-bold text-slate-900 font-head tracking-wide uppercase">Muslim Footballers <span class="text-amber-600">BDG</span></h1>
           <p id="greetingText" class="text-[10px] md:text-xs text-amber-700 font-bold font-arabic tracking-wider">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ø§Ù„Ø±ÙÙ‘Ø­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±ÙÙ‘Ø­ÙÙŠÙ…</p>
        </div>
      </div>
      
      <!-- SEARCH BAR -->
      <div class="flex-1 max-w-md">
          <div class="relative group">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <span class="text-gray-400 group-focus-within:text-amber-500 transition-colors">ğŸ”</span>
              </div>
              <input type="text" id="globalSearchInput" onkeyup="handleGlobalSearch()" 
                     class="block w-full pl-10 pr-3 py-2 border border-gray-200 rounded-full leading-5 bg-gray-50 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-amber-400 focus:border-transparent transition-all sm:text-sm shadow-inner" 
                     placeholder="Cari Pemain, Aset, atau Sponsor...">
          </div>
      </div>

      <div class="text-right hidden md:block flex-shrink-0">
       <div class="text-sm font-bold text-slate-700" id="currentDate"></div>
       <div class="text-xs text-amber-600 font-semibold" id="hijriDate"></div>
      </div>
     </div>
    </div>
   </header>

   <!-- MENU NAVIGASI (FLOATING DOCK STYLE) -->
   <div class="max-w-7xl mx-auto px-4 pt-4 pb-2 sticky top-[70px] z-40">
    <div class="glass-nav rounded-2xl p-2 shadow-lg">
        <div class="flex md:grid md:grid-cols-8 gap-2 overflow-x-auto pb-1 md:pb-0 hide-scrollbar" style="-webkit-overflow-scrolling: touch;">
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center active flex-shrink-0" data-menu="dashboard">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ“Š</div><div class="text-[10px] font-bold uppercase tracking-wider">Beranda</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="islami">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ•Œ</div><div class="text-[10px] font-bold uppercase tracking-wider">Islami</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="anggota">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ‘¥</div><div class="text-[10px] font-bold uppercase tracking-wider">Squad</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="jadwal">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ“…</div><div class="text-[10px] font-bold uppercase tracking-wider">Jadwal</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="match">
                <div class="text-xl mb-1 filter drop-shadow-sm">âš½</div><div class="text-[10px] font-bold uppercase tracking-wider">Match</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="statistik">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ“ˆ</div><div class="text-[10px] font-bold uppercase tracking-wider">Stats</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="inventaris">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ“¦</div><div class="text-[10px] font-bold uppercase tracking-wider">Aset</div>
            </div>
            <div class="menu-item rounded-xl p-2 min-w-[85px] text-center flex-shrink-0" data-menu="sponsor">
                <div class="text-xl mb-1 filter drop-shadow-sm">ğŸ¤</div><div class="text-[10px] font-bold uppercase tracking-wider">Sponsor</div>
            </div>
        </div>
    </div>
   </div>

   <main class="max-w-7xl mx-auto px-4 pb-24 pt-4">
    
    <!-- DASHBOARD VIEW -->
    <div id="dashboardView" class="view-content hidden">
      <!-- HERO SECTION: NEXT MATCH (FULL WIDTH) -->
      <div class="mb-8">
        <div class="relative rounded-2xl overflow-hidden shadow-2xl group min-h-[220px] hover:shadow-amber-500/20 transition-all duration-500 w-full">
            <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1556056504-5c7696c4c28d?q=80&w=2000')] bg-cover bg-center transition-transform duration-700 group-hover:scale-105"></div>
            <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/80 to-transparent"></div>
            <div class="relative p-6 md:p-10 h-full flex flex-col justify-center text-white">
                <div class="flex items-center gap-3 mb-2">
                    <span class="bg-amber-500 text-slate-900 text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider animate-pulse shadow-[0_0_10px_rgba(218,165,32,0.6)]">Next Match</span>
                    <span id="nextMatchDate" class="text-sm text-gray-300 font-medium">Memuat jadwal...</span>
                </div>
                <h2 id="nextMatchTitle" class="text-3xl md:text-5xl font-head font-bold text-white mb-3 uppercase italic leading-none drop-shadow-lg">Menunggu Jadwal</h2>
                <div class="flex items-center gap-6 mt-4">
                    <div class="text-center bg-white/10 backdrop-blur rounded-lg p-2 min-w-[70px] border border-white/10">
                        <div class="text-3xl font-bold font-mono text-amber-400" id="countdownDays">00</div>
                        <div class="text-[10px] uppercase text-gray-300 tracking-widest">Hari</div>
                    </div>
                    <div class="text-2xl font-bold text-gray-500 mb-2">:</div>
                    <div class="text-center bg-white/10 backdrop-blur rounded-lg p-2 min-w-[70px] border border-white/10">
                        <div class="text-3xl font-bold font-mono text-amber-400" id="countdownHours">00</div>
                        <div class="text-[10px] uppercase text-gray-300 tracking-widest">Jam</div>
                    </div>
                </div>
                <button onclick="showMenu('jadwal')" class="absolute bottom-6 right-6 bg-amber-500 hover:bg-amber-400 text-slate-900 px-6 py-2 rounded-full text-sm font-bold transition-all shadow-lg transform hover:scale-105">Lihat Detail â†’</button>
            </div>
        </div>
      </div>

      <!-- MAIN STATS CARDS (UNIFIED DESIGN) -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        
        <!-- Squad Card -->
        <div class="bg-gradient-to-br from-blue-600 to-blue-800 p-5 rounded-2xl shadow-lg shadow-blue-500/20 text-white relative overflow-hidden group hover-lift cursor-pointer border border-blue-500/30" onclick="showMenu('anggota')">
            <div class="absolute -right-4 -bottom-4 text-9xl text-white opacity-10 transform rotate-12 transition-transform group-hover:scale-110">ğŸ‘¥</div>
            <div class="relative z-10">
                <div class="text-[10px] font-bold bg-white/20 text-blue-100 inline-block px-2 py-1 rounded mb-3 shadow-sm backdrop-blur">SQUAD TIM</div>
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center font-bold text-2xl border border-white/20 shadow-inner">
                        ğŸ‘•
                    </div>
                    <div>
                        <h3 id="totalAnggota" class="text-3xl font-bold font-head leading-none text-white">0</h3>
                        <p class="text-xs font-semibold text-blue-100 opacity-80">Pemain Terdaftar</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Matches Card -->
        <div class="bg-gradient-to-br from-purple-600 to-purple-800 p-5 rounded-2xl shadow-lg shadow-purple-500/20 text-white relative overflow-hidden group hover-lift cursor-pointer border border-purple-500/30" onclick="showMenu('match')">
            <div class="absolute -right-4 -bottom-4 text-9xl text-white opacity-10 transform rotate-12 transition-transform group-hover:scale-110">âš½</div>
            <div class="relative z-10">
                <div class="text-[10px] font-bold bg-white/20 text-purple-100 inline-block px-2 py-1 rounded mb-3 shadow-sm backdrop-blur">MATCHES</div>
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-full bg-white/10 flex items-center justify-center font-bold text-2xl border border-white/20 shadow-inner">
                        ğŸŸï¸
                    </div>
                    <div>
                        <h3 id="totalMatches" class="text-3xl font-bold font-head leading-none text-white">0</h3>
                        <p class="text-xs font-semibold text-purple-100 opacity-80">Laga Dimainkan</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Scorer Card -->
        <div class="bg-gradient-to-br from-amber-500 to-orange-600 p-5 rounded-2xl shadow-lg shadow-amber-500/20 text-white relative overflow-hidden group hover-lift cursor-pointer border border-amber-500/30" onclick="showMenu('statistik')">
             <div class="absolute -right-4 -bottom-4 text-9xl text-white opacity-10 transform rotate-12 transition-transform group-hover:scale-110">ğŸ‘‘</div>
             <div class="relative z-10">
                <div class="text-[10px] font-bold bg-black/20 text-amber-100 inline-block px-2 py-1 rounded mb-3 shadow-sm backdrop-blur">TOP SCORER</div>
                <div class="flex items-center gap-4">
                    <div id="topScorerAvatar" class="w-12 h-12 rounded-full bg-white text-orange-600 flex items-center justify-center font-bold text-xl border-2 border-orange-300 shadow-lg">?</div>
                    <div class="overflow-hidden">
                        <h3 id="topScorer" class="text-xl font-bold font-head leading-none text-white truncate w-full">Belum Ada</h3>
                        <p id="topScorerGoals" class="text-xs font-semibold opacity-90 mt-1">0 Goals</p>
                    </div>
                </div>
             </div>
        </div>

         <!-- Top Assist Card -->
         <div class="bg-gradient-to-br from-cyan-500 to-teal-600 p-5 rounded-2xl shadow-lg shadow-cyan-500/20 text-white relative overflow-hidden group hover-lift cursor-pointer border border-cyan-500/30" onclick="showMenu('statistik')">
            <div class="absolute -right-4 -bottom-4 text-9xl text-white opacity-10 transform rotate-12 transition-transform group-hover:scale-110">ğŸ¯</div>
            <div class="relative z-10">
               <div class="text-[10px] font-bold bg-black/20 text-cyan-100 inline-block px-2 py-1 rounded mb-3 shadow-sm backdrop-blur">TOP ASSIST</div>
               <div class="flex items-center gap-4">
                   <div id="topAssistAvatar" class="w-12 h-12 rounded-full bg-white text-teal-600 flex items-center justify-center font-bold text-xl border-2 border-teal-300 shadow-lg">?</div>
                   <div class="overflow-hidden">
                       <h3 id="topAssist" class="text-xl font-bold font-head leading-none text-white truncate w-full">Belum Ada</h3>
                       <p id="topAssistCount" class="text-xs font-semibold opacity-90 mt-1">0 Assists</p>
                   </div>
               </div>
            </div>
       </div>
      </div>
    </div>

    <!-- ISLAMI VIEW (REVAMPED) -->
    <div id="islamiView" class="view-content hidden">
      <!-- HERO ISLAMI -->
      <div class="relative rounded-2xl overflow-hidden mb-6 shadow-xl border border-green-200">
          <div class="absolute inset-0 bg-gradient-to-r from-emerald-800 to-green-600"></div>
          <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"></div>
          <div class="relative p-6 text-white flex flex-col md:flex-row items-center justify-between">
              <div class="mb-4 md:mb-0">
                  <h2 class="text-2xl md:text-3xl font-bold font-head">Islamic Center</h2>
                  <p class="text-green-100 text-sm">Pusat Spiritual Muslim Footballers Bandung</p>
              </div>
              <div class="text-right">
                  <div class="text-4xl font-arabic font-bold text-amber-300" id="hijriDateDisplay">1446 H</div>
                  <div class="text-xs text-green-200 uppercase tracking-widest">Tahun Hijriah</div>
              </div>
          </div>
      </div>

      <!-- JADWAL SHOLAT MODERN GRID -->
      <div class="mb-6">
          <div class="flex items-center justify-between mb-3 px-1">
            <h3 class="text-lg font-bold text-emerald-800 flex items-center gap-2"><span class="text-xl">ğŸ•Œ</span> Waktu Sholat Bandung</h3>
            <span class="text-xs text-gray-500 bg-white px-2 py-1 rounded shadow-sm">Sumber: Kemenag</span>
          </div>
          <div id="prayerSchedule" class="grid grid-cols-2 md:grid-cols-5 gap-3">
              <!-- Cards will be injected here -->
          </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <!-- RENUNGAN CARD -->
        <div class="lg:col-span-2 glass-effect rounded-xl p-0 overflow-hidden shadow-lg border-t-4 border-amber-500">
            <div class="bg-amber-50 p-4 border-b border-amber-100 flex justify-between items-center">
                <h3 class="font-bold text-amber-800 flex items-center gap-2">ğŸ’ Renungan Hari Ini</h3>
                <button onclick="refreshRenungan()" class="text-xs bg-white border border-amber-300 px-3 py-1 rounded-full hover:bg-amber-100 text-amber-700 transition shadow-sm">ğŸ”„ Refresh Ayat</button>
            </div>
            <div class="p-6 md:p-8 bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')]">
                 <div class="mb-6 text-center">
                    <p class="text-xs text-gray-500 mb-2 tracking-widest uppercase">Kalamullah (Random)</p>
                    <div id="ayatContainer">
                        <p id="ayatText" class="text-2xl md:text-3xl font-arabic text-slate-800 leading-loose mb-4" style="line-height: 2.2;">Sedang memuat ayat...</p>
                        <p id="ayatTranslation" class="text-sm text-gray-600 italic border-l-2 border-amber-400 pl-4 inline-block"></p>
                    </div>
                 </div>
                 <div class="bg-emerald-50 p-4 rounded-lg border border-emerald-100 relative">
                    <span class="absolute -top-3 left-4 bg-emerald-600 text-white text-[10px] px-2 py-0.5 rounded uppercase font-bold">Hadist Pilihan</span>
                    <p id="hadistText" class="text-sm text-emerald-900 leading-relaxed font-medium mt-1"></p>
                 </div>
            </div>
        </div>

        <!-- SIDEBAR: DOA PILIHAN (FIXED WITH MODAL & ONLINE FETCH) -->
        <div class="space-y-6">
             <!-- Doa Section -->
             <div class="glass-effect rounded-xl p-5 shadow-md">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-emerald-700 flex items-center gap-2">ğŸ¤² Doa Harian Online</h3>
                    <button onclick="getOnlineDoa()" class="text-xs text-emerald-600 hover:text-emerald-800 font-semibold bg-emerald-50 px-2 py-1 rounded">ğŸ”„ Reload</button>
                </div>
                <!-- Container Doa -->
                <div id="doaListContainer" class="space-y-2 max-h-[300px] overflow-y-auto pr-1">
                    <div class="text-center py-4 text-gray-500 text-sm animate-pulse">Mengambil data doa online...</div>
                </div>
             </div>

             <!-- Info Kiblat (Static Mockup) -->
             <div class="bg-slate-800 text-white rounded-xl p-5 shadow-lg relative overflow-hidden">
                <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl">ğŸ§­</div>
                <h3 class="text-sm font-bold text-gray-400 uppercase mb-1">Arah Kiblat</h3>
                <div class="flex items-center gap-4 mt-2">
                    <div class="text-3xl font-bold text-amber-400">295Â°</div>
                    <div class="text-xs text-gray-300">Barat Laut<br>dari Bandung</div>
                </div>
             </div>
        </div>
      </div>

      <!-- KAJIAN SECTION -->
      <div class="glass-effect rounded-xl p-6 admin-only">
        <h2 class="text-xl font-bold text-amber-600 mb-4 flex items-center gap-2"><span>ğŸ“š</span> Kelola Jadwal Kajian</h2>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-3 mb-4">
            <input type="text" id="kajianTopic" placeholder="Topik Kajian" class="px-4 py-2 border border-amber-300 rounded-lg focus:ring-2 focus:ring-amber-400"> 
            <input type="date" id="kajianDate" class="px-4 py-2 border border-amber-300 rounded-lg"> 
            <input type="time" id="kajianTime" class="px-4 py-2 border border-amber-300 rounded-lg"> 
            <input type="text" id="kajianSpeaker" placeholder="Pemateri/Ustadz" class="px-4 py-2 border border-amber-300 rounded-lg">
        </div>
        <button onclick="addKajian()" class="w-full gold-gradient text-white px-4 py-3 rounded-lg hover:opacity-90 font-semibold shadow-md transform active:scale-95 transition"> â• Tambah Jadwal Kajian </button>
      </div>
      
      <!-- KAJIAN LIST PUBLIC -->
      <div class="mt-6">
        <h3 class="text-lg font-bold text-slate-700 mb-4 px-1">Agenda Kajian Rutin</h3>
        <div id="kajianList" class="space-y-3">
            <!-- Kajian items injected here -->
        </div>
      </div>

    </div>

    <!-- ANGGOTA VIEW (REVAMPED: PLAYER GALLERY) -->
    <div id="anggotaView" class="view-content hidden">
      
      <!-- Hero Squad -->
      <div class="relative rounded-2xl overflow-hidden mb-8 shadow-xl bg-slate-900 text-white min-h-[220px] flex items-center">
          <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1579952363873-27f3bade9f55?q=80&w=2000')] bg-cover bg-center opacity-40"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/80 to-transparent"></div>
          <div class="relative p-8 z-10 max-w-2xl">
              <span class="text-amber-400 font-bold tracking-widest text-xs uppercase mb-2 block">Daftar Pemain Resmi</span>
              <h2 class="text-4xl md:text-5xl font-head font-bold leading-tight mb-2">The Squad</h2>
              <p class="text-gray-300 text-sm mb-6 max-w-md">Barisan pejuang lapangan hijau. Menjunjung tinggi sportivitas dan ukhuwah islamiyah.</p>
              <button onclick="document.getElementById('joinFormSection').scrollIntoView({behavior: 'smooth'})" class="bg-amber-500 hover:bg-amber-600 text-slate-900 px-6 py-2 rounded-full font-bold text-sm transition shadow-lg transform hover:scale-105">Gabung Tim</button>
          </div>
      </div>

      <!-- Player Gallery (FUT Style Grid) -->
      <div class="mb-10">
          <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2 border-l-4 border-amber-500 pl-3">
              <span>ğŸ‘¥</span> Galeri Pemain
          </h3>
          
          <div class="flex items-center justify-between mb-4 px-2">
              <span class="text-xs text-gray-500 font-semibold" id="totalPlayerCount">Memuat pemain...</span>
              <div class="admin-only flex gap-2">
                 <button onclick="exportMembersCSV()" class="bg-green-100 text-green-700 px-3 py-1 rounded-lg text-xs font-bold hover:bg-green-200">ğŸ“¥ CSV</button> 
                 <label class="bg-blue-100 text-blue-700 px-3 py-1 rounded-lg text-xs font-bold hover:bg-blue-200 cursor-pointer">ğŸ“¤ Import <input type="file" accept=".csv" onchange="processImport(event)" class="hidden"></label>
              </div>
          </div>

          <div id="memberList" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5">
              <!-- Cards Rendered via JS -->
          </div>
      </div>

      <!-- Join Form Section -->
      <div id="joinFormSection" class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 relative overflow-hidden">
         <div class="absolute top-0 right-0 p-10 opacity-5 text-9xl rotate-12">ğŸ“</div>
         <div class="relative z-10">
             <h2 class="text-2xl font-bold text-slate-800 mb-2 font-head">Formulir Pendaftaran</h2>
             <p class="text-gray-500 text-sm mb-6">Isi data diri Anda dengan lengkap untuk bergabung.</p>
             
             <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-5">
                 <div class="col-span-1 md:col-span-2">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nama Lengkap</label>
                     <input type="text" id="memberName" placeholder="Masukkan nama..." class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 focus:border-transparent bg-gray-50">
                 </div>
                 
                 <div>
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Posisi Utama</label>
                     <select id="memberPosition" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 bg-white"> 
                        <option value="Gelandang">Gelandang (MID)</option> 
                        <option value="Striker">Striker (FWD)</option> 
                        <option value="Bek">Bek (DEF)</option> 
                        <option value="Kiper">Kiper (GK)</option> 
                     </select> 
                 </div>
                 
                 <div>
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nomor WhatsApp</label>
                     <input type="tel" id="memberPhone" placeholder="08..." class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 bg-gray-50">
                 </div>

                 <div>
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Skill Level</label>
                     <select id="memberSkill" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 bg-white"> 
                        <option value="Pemula">â­ Pemula</option> 
                        <option value="Menengah">â­â­ Menengah</option> 
                        <option value="Mahir">â­â­â­ Mahir</option> 
                     </select> 
                 </div>

                 <div>
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">URL Foto Profil (Opsional)</label>
                     <input type="text" id="memberPhoto" placeholder="https://..." class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 bg-gray-50">
                 </div>
                 
                 <div class="col-span-1 md:col-span-2">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Ketersediaan</label>
                     <select id="memberAvailability" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-400 bg-white"> 
                        <option value="Fleksibel">Fleksibel</option> 
                        <option value="Weekend">Weekend Only</option> 
                        <option value="Weekday">Weekday Only</option> 
                     </select> 
                 </div>
             </div>
             
             <button onclick="addMember()" class="w-full bg-gradient-to-r from-amber-500 to-amber-600 text-white font-bold py-4 rounded-xl shadow-lg hover:shadow-amber-500/30 transform hover:-translate-y-1 transition-all"> 
                â• Simpan Data Pemain 
             </button>
         </div>
      </div>
    </div>

    <!-- JADWAL VIEW (REVAMPED) -->
    <div id="jadwalView" class="view-content hidden">
      <!-- Hero Section -->
      <div class="relative rounded-2xl overflow-hidden mb-8 shadow-xl bg-slate-900 text-white min-h-[200px] flex items-center">
          <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1522778119026-d647f0565c6d?q=80&w=2000')] bg-cover bg-center opacity-40"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/80 to-transparent"></div>
          <div class="relative p-8 z-10 max-w-2xl">
              <span class="text-amber-400 font-bold tracking-widest text-xs uppercase mb-2 block">Kalender Kegiatan</span>
              <h2 class="text-3xl md:text-4xl font-head font-bold leading-tight mb-4">Jadwal Pertandingan <br>& Latihan</h2>
              <p class="text-gray-300 text-sm mb-6">Jangan lewatkan setiap momen perjuangan tim. Catat tanggalnya!</p>
              <button onclick="document.getElementById('scheduleSectionAdmin').scrollIntoView({behavior: 'smooth'})" class="admin-only bg-amber-500 hover:bg-amber-600 text-slate-900 px-6 py-2 rounded-full font-bold text-sm transition shadow-lg">Tambah Jadwal</button>
          </div>
      </div>

      <!-- Schedule List -->
      <div class="mb-10">
          <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2 border-l-4 border-amber-500 pl-3">
              <span>ğŸ“…</span> Agenda Mendatang
          </h3>
          <div id="scheduleList" class="space-y-4">
              <!-- Rendered via JS -->
          </div>
      </div>

      <!-- Add Schedule Form (Admin) -->
      <div id="scheduleSectionAdmin" class="glass-effect rounded-xl p-6 mb-6 admin-only border border-amber-200">
       <h2 class="text-xl font-bold text-amber-600 mb-4">ğŸ“… Buat Jadwal Baru</h2>
       <div class="mb-4"><select id="scheduleType" class="w-full px-4 py-3 border border-amber-300 rounded-xl bg-white font-semibold text-gray-700 focus:ring-2 focus:ring-amber-400"> <option value="">-- Pilih Jenis Kegiatan --</option> <option value="Friendly Match">ğŸ¤ Friendly Match</option> <option value="Fun Football">âš½ Fun Football Internal</option> </select></div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="text" id="scheduleName" placeholder="Nama Lawan / Kegiatan" class="px-4 py-3 border border-amber-300 rounded-xl focus:ring-2 focus:ring-amber-400"> <input type="date" id="scheduleDate" class="px-4 py-3 border border-amber-300 rounded-xl focus:ring-2 focus:ring-amber-400"></div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="time" id="scheduleTime" class="px-4 py-3 border border-amber-300 rounded-xl focus:ring-2 focus:ring-amber-400"> <input type="text" id="scheduleLocation" placeholder="Lokasi Lapangan" class="px-4 py-3 border border-amber-300 rounded-xl focus:ring-2 focus:ring-amber-400"></div><button onclick="addSchedule()" class="w-full gold-gradient text-white px-4 py-3 rounded-xl hover:opacity-90 font-semibold shadow-md transform active:scale-95 transition"> ğŸ’¾ Simpan Jadwal </button>
      </div>
    </div>

    <!-- MATCH VIEW -->
    <div id="matchView" class="view-content hidden">
      <div class="glass-effect rounded-xl p-6 mb-6 admin-only">
       <h2 class="text-xl font-bold text-amber-600 mb-4">âš½ Input Hasil Pertandingan</h2>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="text" id="matchOpponent" placeholder="Nama Lawan" class="px-4 py-2 border border-amber-300 rounded-lg"> <input type="date" id="matchDate" class="px-4 py-2 border border-amber-300 rounded-lg"></div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="text" id="matchLocation" placeholder="Lokasi" class="px-4 py-2 border border-amber-300 rounded-lg"> <select id="matchType" class="px-4 py-2 border border-amber-300 rounded-lg"> <option value="">Jenis Match</option> <option value="Friendly">Friendly Match</option> <option value="Fun Football">Fun Football</option> </select></div>
       <div class="grid grid-cols-2 gap-4 mb-4"><input type="number" id="matchScoreUs" placeholder="Skor Kami" min="0" class="px-4 py-2 border border-amber-300 rounded-lg"> <input type="number" id="matchScoreOpponent" placeholder="Skor Lawan" min="0" class="px-4 py-2 border border-amber-300 rounded-lg"></div><button onclick="addMatch()" class="w-full gold-gradient text-white px-4 py-3 rounded-lg hover:opacity-90 font-semibold"> ğŸ’¾ Simpan Hasil Match </button>
      </div>
      <div class="glass-effect rounded-xl p-6"><h2 class="text-xl font-bold text-amber-600 mb-4">ğŸ† Riwayat Pertandingan</h2><div id="matchList" class="space-y-3"></div></div>
    </div>

    <!-- STATISTIK VIEW -->
    <div id="statistikView" class="view-content hidden">
      <div class="glass-effect rounded-xl p-6 mb-6 admin-only">
       <h2 class="text-xl font-bold text-amber-600 mb-4">ğŸ“Š Input Statistik Pemain</h2>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><select id="statsPlayerName" class="px-4 py-2 border border-amber-300 rounded-lg bg-white font-bold text-gray-700"> <option value="">-- Pilih Pemain --</option> </select> <input type="date" id="statsDate" class="px-4 py-2 border border-amber-300 rounded-lg"></div>
       <div class="grid grid-cols-3 gap-3 mb-4"><div><label class="text-xs text-gray-500">Gol (3 Poin)</label> <input type="number" id="statsGoals" placeholder="0" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></div><div><label class="text-xs text-gray-500">Assist (1 Poin)</label> <input type="number" id="statsAssists" placeholder="0" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></div><div><label class="text-xs text-gray-500">Saves (1 Poin)</label> <input type="number" id="statsSaves" placeholder="0" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-lg"></div></div>
       <div class="mb-4 bg-amber-50 p-3 rounded-lg border border-amber-200"><p class="text-xs font-bold text-amber-700 mb-2">Kelengkapan & Bonus:</p><div class="grid grid-cols-2 gap-2"><label class="flex items-center space-x-2 cursor-pointer"> <input type="checkbox" id="statsJersey" class="w-4 h-4 text-amber-600 rounded"> <span class="text-sm">ğŸ‘• Pakai Jersey (+2)</span> </label> <label class="flex items-center space-x-2 cursor-pointer"> <input type="checkbox" id="statsCleanSheet" class="w-4 h-4 text-amber-600 rounded"> <span class="text-sm">ğŸ§¤ Clean Sheet (+3)</span> </label></div></div>
       <div class="mb-4 bg-green-50 p-3 rounded-lg border border-green-200"><p class="text-xs font-bold text-green-700 mb-2">Penghargaan Khusus:</p><div class="grid grid-cols-2 gap-2 text-sm"><label class="flex items-center space-x-2"><input type="checkbox" id="statsPOTM" class="w-4 h-4"> <span>ğŸ… Match (+3)</span></label> <label class="flex items-center space-x-2"><input type="checkbox" id="statsPOTW" class="w-4 h-4"> <span>â­ Week (+3)</span></label> <label class="flex items-center space-x-2"><input type="checkbox" id="statsBestXI" class="w-4 h-4"> <span>ğŸ›¡ï¸ Best XI (+3)</span></label> <label class="flex items-center space-x-2"><input type="checkbox" id="statsPOTMonth" class="w-4 h-4"> <span>ğŸ‘‘ Month (+5)</span></label></div></div><button onclick="addStats()" class="w-full gold-gradient text-white px-4 py-3 rounded-lg hover:opacity-90 font-semibold"> ğŸ’¾ Simpan Statistik </button>
      </div>
      <div class="glass-effect rounded-xl p-6"><h2 class="text-xl font-bold text-amber-600 mb-4">ğŸ“Š Klasemen Pemain</h2><div id="statsList" class="space-y-3"></div></div>
    </div>

    <!-- INVENTARIS VIEW (REVAMPED) -->
    <div id="inventarisView" class="view-content hidden">
      <!-- Header Inventaris -->
      <div class="relative rounded-2xl overflow-hidden mb-8 shadow-xl bg-slate-800 text-white min-h-[180px] flex items-center">
          <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1522778119026-d647f0565c6d?q=80&w=2000')] bg-cover bg-center opacity-40"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/80 to-transparent"></div>
          <div class="relative p-8 z-10 max-w-2xl">
              <span class="text-amber-400 font-bold tracking-widest text-xs uppercase mb-2 block">Gudang & Logistik</span>
              <h2 class="text-3xl md:text-4xl font-head font-bold leading-tight mb-2">Manajemen Aset Tim</h2>
              <p class="text-gray-300 text-sm mb-4">Pastikan perlengkapan tempur selalu siap sedia.</p>
              <button onclick="document.getElementById('inventorySectionAdmin').scrollIntoView({behavior: 'smooth'})" class="admin-only bg-amber-500 hover:bg-amber-600 text-slate-900 px-5 py-2 rounded-full font-bold text-xs transition shadow-lg">Tambah Aset</button>
          </div>
      </div>

      <!-- Inventory Grid -->
      <div class="mb-8">
          <div id="inventoryList" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
              <!-- Rendered via JS -->
          </div>
      </div>

      <!-- Add Inventory Form (Admin Only) -->
      <div id="inventorySectionAdmin" class="glass-effect rounded-xl p-6 mb-6 admin-only border border-amber-200">
       <h2 class="text-xl font-bold text-amber-600 mb-4 flex items-center gap-2">ğŸ“¦ Catat Aset Baru</h2>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
           <input type="text" id="itemName" placeholder="Nama Barang (Misal: Bola Adidas)" class="px-4 py-2 border border-amber-300 rounded-lg"> 
           <input type="text" id="itemImage" placeholder="URL Foto Barang (https://...)" class="px-4 py-2 border border-amber-300 rounded-lg">
       </div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
           <input type="number" id="itemQuantity" placeholder="Jumlah Stok" min="0" class="px-4 py-2 border border-amber-300 rounded-lg"> 
           <select id="itemCondition" class="w-full px-4 py-2 border border-amber-300 rounded-lg bg-amber-50 font-semibold"> 
                <option value="">-- Kondisi Fisik --</option> 
                <option value="Baik">âœ… Baik (Layak Pakai)</option> 
                <option value="Cukup">âš ï¸ Cukup (Ada Lecet)</option> 
                <option value="Perlu Diganti">âŒ Rusak / Perlu Ganti</option> 
           </select>
       </div>
       <button onclick="addInventory()" class="w-full gold-gradient text-white px-4 py-3 rounded-lg hover:opacity-90 font-semibold shadow-md"> â• Simpan ke Inventaris </button>
      </div>
    </div>

    <!-- SPONSOR VIEW (REVAMPED CLEANED) -->
    <div id="sponsorView" class="view-content hidden">
      <!-- Header Sponsor -->
      <div class="relative rounded-2xl overflow-hidden mb-8 shadow-xl bg-slate-900 text-white min-h-[200px] flex items-center">
          <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1517466787929-bc90951d0974?q=80&w=2000')] bg-cover bg-center opacity-40"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-slate-900 via-slate-900/80 to-transparent"></div>
          <div class="relative p-8 z-10 max-w-2xl">
              <span class="text-amber-400 font-bold tracking-widest text-xs uppercase mb-2 block">Mitra & Pendukung</span>
              <h2 class="text-3xl md:text-4xl font-head font-bold leading-tight mb-4">Sempurnakan Do'a <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-yellow-200">Maksimalkan Ikhtiar</span></h2>
              <p class="text-gray-300 text-sm mb-6">Terima kasih kepada para donatur dan sponsor yang telah mendukung operasional Muslim Footballers Bandung.</p>
              <button onclick="handleManageSponsor()" class="bg-amber-500 hover:bg-amber-600 text-slate-900 px-6 py-2 rounded-full font-bold text-sm transition shadow-lg transform hover:scale-105">Kelola Sponsor</button>
          </div>
      </div>

      <!-- Sponsor Wall -->
      <div class="mb-8">
          <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2 border-l-4 border-amber-500 pl-3">
              <span>ğŸ†</span> Wall of Fame
          </h3>
          
          <div id="sponsorListGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <!-- Rendered via JS -->
          </div>
      </div>

      <!-- Add Sponsor Form (Admin Only) -->
      <div id="sponsorSectionAdmin" class="glass-effect rounded-xl p-6 mb-6 admin-only border border-amber-200">
       <h2 class="text-xl font-bold text-amber-600 mb-4">ğŸ¤ Tambah Sponsor/Donatur Baru</h2>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
           <input type="text" id="sponsorName" placeholder="Nama Sponsor / Donatur" class="px-4 py-2 border border-amber-300 rounded-lg"> 
           <input type="text" id="sponsorImage" placeholder="Link Logo (https://...)" class="px-4 py-2 border border-amber-300 rounded-lg">
       </div>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
           <input type="text" id="sponsorContact" placeholder="Kontak / Keterangan" class="px-4 py-2 border border-amber-300 rounded-lg"> 
           <div class="flex gap-2">
               <input type="number" id="sponsorAmount" placeholder="Jumlah Donasi (Rp)" min="0" class="w-full px-4 py-2 border border-amber-300 rounded-lg">
               <select id="sponsorTier" class="w-full px-4 py-2 border border-amber-300 rounded-lg bg-amber-50 font-semibold">
                   <option value="3">Tier 3 (Silver)</option>
                   <option value="2">Tier 2 (Gold)</option>
                   <option value="1">Tier 1 (Platinum)</option>
               </select>
           </div>
       </div>
       <button onclick="addSponsor()" class="w-full gold-gradient text-white px-4 py-3 rounded-lg hover:opacity-90 font-semibold shadow-md"> â• Tambah ke Database </button>
      </div>
    </div>
   </main>
  </div>

  <div id="adminBtn" class="admin-toggle" onclick="toggleAdmin()">ğŸ”’</div>

  <!-- MODALS -->
  <div id="loginModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm"><div class="bg-white p-6 rounded-xl shadow-2xl w-80 text-center border-2 border-amber-400"><h3 class="text-xl font-bold text-amber-600 mb-4 font-arabic">ğŸ”‘ Login Admin</h3><input type="password" id="adminPassInput" placeholder="Masukkan Password..." class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:border-amber-500"><div class="flex gap-2"><button onclick="submitLogin()" class="flex-1 bg-amber-500 text-white py-2 rounded-lg hover:bg-amber-600 font-bold">Masuk</button> <button onclick="closeAdminModal()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300">Batal</button></div></div></div>
  <div id="editInventoryModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm"><div class="bg-white p-6 rounded-xl shadow-2xl w-96 border-2 border-blue-400"><h3 class="text-xl font-bold text-blue-600 mb-4">âœï¸ Edit Inventaris</h3><div class="space-y-3"><input type="text" id="editItemName" placeholder="Nama Item" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <input type="text" id="editItemImage" placeholder="Link Foto (opsional)" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <input type="number" id="editItemQuantity" placeholder="Jumlah" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <select id="editItemCondition" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="Baik">Baik</option> <option value="Cukup">Cukup</option> <option value="Perlu Diganti">Perlu Diganti</option> </select></div><div class="flex gap-2 mt-4"><button onclick="saveEditInventory()" class="flex-1 bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 font-bold">ğŸ’¾ Simpan</button> <button onclick="closeEditInventoryModal()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300">Batal</button></div></div></div>
  
  <!-- EDIT SPONSOR MODAL -->
  <div id="editSponsorModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/50 backdrop-blur-sm">
      <div class="bg-white p-6 rounded-xl shadow-2xl w-96 border-2 border-pink-400">
          <h3 class="text-xl font-bold text-pink-600 mb-4">âœï¸ Edit Sponsor</h3>
          <div class="space-y-3">
              <input type="text" id="editSponsorName" placeholder="Nama Sponsor" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> 
              <input type="text" id="editSponsorImage" placeholder="Link Logo (https://...)" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> 
              <input type="text" id="editSponsorContact" placeholder="Kontak" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> 
              <input type="number" id="editSponsorAmount" placeholder="Jumlah Donasi (Rp)" class="w-full px-4 py-2 border border-gray-300 rounded-lg">
              <select id="editSponsorTier" class="w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50">
                   <option value="3">Tier 3 (Silver)</option>
                   <option value="2">Tier 2 (Gold)</option>
                   <option value="1">Tier 1 (Platinum)</option>
               </select>
          </div>
          <div class="flex gap-2 mt-4">
              <button onclick="saveEditSponsor()" class="flex-1 bg-pink-500 text-white py-2 rounded-lg hover:bg-pink-600 font-bold">ğŸ’¾ Simpan</button> 
              <button onclick="closeEditSponsorModal()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg hover:bg-gray-300">Batal</button>
          </div>
      </div>
  </div>

  <div id="playerModal" class="hidden fixed inset-0 z-[9000] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4"><div class="glass-effect w-full max-w-lg rounded-2xl overflow-hidden shadow-2xl relative bg-white"><button onclick="closePlayerModal()" class="absolute top-4 right-4 text-gray-500 hover:text-red-500 z-10 text-xl">âœ–</button><div class="bg-gradient-to-r from-amber-400 to-yellow-300 p-6 text-center"><div class="w-20 h-20 bg-white rounded-full mx-auto flex items-center justify-center text-4xl shadow-lg border-4 border-white mb-3">ğŸ‘¤</div><h2 id="modalPlayerName" class="text-2xl font-bold text-amber-900 font-arabic">Nama Pemain</h2><p id="modalPlayerPos" class="text-amber-800 font-semibold">Posisi</p></div><div class="p-6"><div class="grid grid-cols-3 gap-2 text-center mb-6"><div class="p-2 bg-amber-50 rounded-lg"><div class="text-xs text-gray-500">Main</div><div id="modalStatsCaps" class="text-xl font-bold text-amber-600">0</div></div><div class="p-2 bg-green-50 rounded-lg"><div class="text-xs text-gray-500">Gol</div><div id="modalStatsGoals" class="text-xl font-bold text-green-600">0</div></div><div class="p-2 bg-blue-50 rounded-lg"><div class="text-xs text-gray-500">Assist</div><div id="modalStatsAssist" class="text-xl font-bold text-blue-600">0</div></div></div><h3 class="font-bold text-gray-700 mb-2 border-b pb-1">Riwayat Performa</h3><div id="modalHistoryList" class="max-h-48 overflow-y-auto space-y-2 text-sm"></div></div></div></div>
  <!-- EDIT MEMBER MODAL (UPDATED WITH PHOTO URL) -->
  <div id="editMemberModal" class="hidden fixed inset-0 z-[9500] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4"><div class="bg-white w-full max-w-2xl rounded-2xl overflow-hidden shadow-2xl"><div class="bg-gradient-to-r from-blue-500 to-blue-400 p-4 text-center"><h3 class="text-xl font-bold text-white">âœï¸ Edit Data Anggota</h3></div><div class="p-6"><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="text" id="editMemberName" placeholder="Nama Lengkap" class="px-4 py-2 border border-gray-300 rounded-lg"> <select id="editMemberPosition" class="px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Pilih Posisi</option> <option value="Kiper">Kiper</option> <option value="Bek">Bek</option> <option value="Gelandang">Gelandang</option> <option value="Striker">Striker</option> </select></div><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><input type="tel" id="editMemberPhone" placeholder="No. Telepon" class="px-4 py-2 border border-gray-300 rounded-lg"> <select id="editMemberSkill" class="px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Level Keahlian</option> <option value="Pemula">Pemula</option> <option value="Menengah">Menengah</option> <option value="Mahir">Mahir</option> </select></div><div class="mb-4"><input type="text" id="editMemberPhoto" placeholder="URL Foto (https://...)" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-4"> <select id="editMemberAvailability" class="w-full px-4 py-2 border border-gray-300 rounded-lg"> <option value="">Ketersediaan</option> <option value="Weekday">Weekday</option> <option value="Weekend">Weekend</option> <option value="Fleksibel">Fleksibel</option> </select></div><div class="flex gap-3"><button onclick="saveEditMember()" class="flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 font-bold">ğŸ’¾ Simpan Perubahan</button> <button onclick="closeEditMemberModal()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg hover:bg-gray-300 font-bold">âŒ Batal</button></div></div></div></div>
  
  <!-- NEW PRAYER MODAL (UPDATED WITH BUTTON) -->
  <div id="prayerModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4">
    <div class="glass-effect w-full max-w-md rounded-2xl overflow-hidden shadow-2xl relative bg-white border-2 border-emerald-400 flex flex-col max-h-[90vh]">
         <div class="bg-gradient-to-r from-emerald-600 to-green-500 p-6 text-center flex-shrink-0">
            <div class="w-16 h-16 bg-white/20 rounded-full mx-auto flex items-center justify-center text-3xl shadow-inner backdrop-blur-sm mb-3">ğŸ¤²</div>
            <h2 id="modalPrayerTitle" class="text-xl font-bold text-white font-head tracking-wide">Judul Doa</h2>
         </div>
         <div class="p-6 text-center space-y-4 bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')] overflow-y-auto flex-1">
            <p id="modalPrayerArabic" class="text-2xl font-arabic text-emerald-900 leading-loose dir-rtl"></p>
            <div class="h-px bg-emerald-200 w-1/2 mx-auto"></div>
            <p id="modalPrayerTrans" class="text-sm text-slate-600 italic leading-relaxed"></p>
         </div>
         <div class="p-4 bg-gray-50 border-t border-gray-200 flex-shrink-0">
            <button onclick="closePrayerModal()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-3 rounded-xl transition-colors shadow-sm">
                Tutup Kartu Doa
            </button>
         </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
    import { getFirestore, collection, addDoc, updateDoc, deleteDoc, doc, onSnapshot, query, orderBy } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

    // --- FIREBASE CONFIGURATION ---
    const myFirebaseConfig = {
      apiKey: "AIzaSyDXA6RxsaZN1wL-fUEsvipbBonUMZac4Y4",
      authDomain: "muslimfootballers-bandung.firebaseapp.com",
      projectId: "muslimfootballers-bandung",
      storageBucket: "muslimfootballers-bandung.firebasestorage.app",
      messagingSenderId: "546357578832",
      appId: "1:546357578832:web:87b8759b4c0fe9198dd555",
      measurementId: "G-6X09T9TVMJ"
    };

    // --- SYSTEM SETUP ---
    let firebaseConfig;
    if (typeof __firebase_config !== 'undefined') {
        firebaseConfig = JSON.parse(__firebase_config);
    } else {
        firebaseConfig = myFirebaseConfig;
    }

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

    let currentUser = null;
    let allData = [];
    let currentMenu = 'dashboard';
    let currentEditingRecord = null;
    let countdownInterval = null;
    let searchQuery = ""; // GLOBAL SEARCH QUERY
    
    const initAuth = async () => {
        try {
            if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                await signInWithCustomToken(auth, __initial_auth_token);
            } else {
                await signInAnonymously(auth);
            }
        } catch (error) {
            console.error("Auth Error:", error);
        }
    };
    initAuth();

    onAuthStateChanged(auth, (user) => {
        currentUser = user;
        if (user) {
            setupDataListener(user);
        }
    });

    function setupDataListener(user) {
        const q = collection(db, 'artifacts', appId, 'public', 'data', 'universal_data');
        onSnapshot(q, (snapshot) => {
            allData = snapshot.docs.map(doc => ({
                ...doc.data(),
                __backendId: doc.id
            }));
            
            // Re-render current view with new data
            renderCurrentView();
            
            // Updates that don't depend on view
            renderKajianList();
            renderPrayerSchedule();
            updateDashboard(); // Always update dashboard stats in background
            if(currentMenu === 'statistik') updatePlayerDropdown();
        }, (error) => {
            console.error("Data fetch error:", error);
        });
    }

    // --- GLOBAL SEARCH LOGIC ---
    window.handleGlobalSearch = function() {
        const input = document.getElementById('globalSearchInput');
        searchQuery = input.value.toLowerCase();
        renderCurrentView();
    }

    function renderCurrentView() {
        if(currentMenu === 'dashboard') updateDashboard();
        else if(currentMenu === 'anggota') renderMembers();
        else if(currentMenu === 'inventaris') renderInventory();
        else if(currentMenu === 'sponsor') renderSponsors();
        else if(currentMenu === 'jadwal') renderSchedules();
        else if(currentMenu === 'match') renderMatches();
        else if(currentMenu === 'statistik') renderStats();
    }

    // --- CRUD WRAPPERS ---
    async function createData(data) {
        if (!currentUser) return;
        try {
            await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'universal_data'), data);
        } catch (e) {
            console.error(e);
            showToast("Gagal menyimpan (Cek Console)", "error");
        }
    }

    async function updateData(data) {
        if (!currentUser) return;
        try {
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'universal_data', data.__backendId);
            const { __backendId, ...updatePayload } = data;
            await updateDoc(docRef, updatePayload);
        } catch (e) {
            console.error(e);
            showToast("Gagal update", "error");
        }
    }

    async function deleteData(id) {
        if (!currentUser) return;
        try {
            await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'universal_data', id));
            showToast("Data dihapus");
        } catch (e) {
            console.error(e);
            showToast("Gagal menghapus", "error");
        }
    }

    // --- APP LOGIC ---

    const hadistDatabase = [ 
        "Mukmin yang kuat lebih baik dan lebih dicintai Allah daripada mukmin yang lemah. (HR. Muslim)",
        "Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia lainnya. (HR. Ahmad)",
        "Barangsiapa menempuh jalan untuk menuntut ilmu, Allah mudahkan baginya jalan menuju surga. (HR. Muslim)",
        "Senyummu di hadapan saudaramu adalah sedekah bagimu. (HR. Tirmidzi)"
    ];

    function initializeAppUI() {
      updateDates(); 
      setInterval(updateDates, 60000); 
      displayRenungan(); 
      renderPrayerSchedule();
      getOnlineDoa(); // Load doa online at start
      
      document.querySelectorAll('.menu-item').forEach(card => card.addEventListener('click', () => {
        showMenu(card.dataset.menu);
        if(card.dataset.menu === 'islami') getOnlineDoa(); 
      }));
      
      if(localStorage.getItem('isAdmin') === 'true') {
        document.body.classList.add('is-admin');
        document.getElementById('adminBtn').textContent='ğŸ”“';
      }
    }

    function updateDates() { 
        const now = new Date(); 
        document.getElementById('currentDate').textContent = now.toLocaleDateString('id-ID', { weekday:'long', year:'numeric', month:'long', day:'numeric' }); 
        document.getElementById('hijriDate').textContent = '1446 H';
        
        const hijriEl = document.getElementById('hijriDateDisplay');
        if(hijriEl) hijriEl.textContent = '1446 H'; 
    }
    
    window.showMenu = function(menu) { 
        currentMenu = menu; 
        
        // Reset Search when changing menu
        searchQuery = "";
        const searchInput = document.getElementById('globalSearchInput');
        if(searchInput) searchInput.value = "";

        document.querySelectorAll('.menu-item').forEach(c => c.classList.remove('active')); 
        const activeItem = document.querySelector(`[data-menu="${menu}"]`);
        if(activeItem) activeItem.classList.add('active'); 
        
        document.querySelectorAll('.view-content').forEach(v => v.classList.add('hidden')); 
        const view = document.getElementById(menu + 'View');
        if(view) view.classList.remove('hidden'); 
        
        renderCurrentView(); // Render appropriate content
        
        if(menu === 'statistik') updatePlayerDropdown(); 
    }
    
    // --- DASHBOARD REVAMP LOGIC ---
    function updateDashboard() {
        // Basic Stats
        const members = allData.filter(d=>d.type==='member'); 
        const matches = allData.filter(d=>d.type==='match');
        
        const elTotalAnggota = document.getElementById('totalAnggota');
        if(elTotalAnggota) elTotalAnggota.textContent = members.length;
        
        const elTotalMatches = document.getElementById('totalMatches');
        if(elTotalMatches) elTotalMatches.textContent = matches.length;
        
        // Top Scorer & Assist Logic
        const stats = allData.filter(d=>d.type==='stats');
        const goals = {}; const assists = {};
        stats.forEach(s=>{ 
            if(!goals[s.member_id]) goals[s.member_id]={name:'', val:0}; goals[s.member_id].val+=(parseInt(s.goals)||0);
            if(!assists[s.member_id]) assists[s.member_id]={name:'', val:0}; assists[s.member_id].val+=(parseInt(s.assists)||0);
            const m = members.find(x=>x.__backendId===s.member_id); if(m) { goals[s.member_id].name=m.name; assists[s.member_id].name=m.name; }
        });
        
        const topG = Object.values(goals).sort((a,b)=>b.val-a.val)[0]; 
        if(topG) {
            if(document.getElementById('topScorer')) document.getElementById('topScorer').textContent = topG.name; 
            if(document.getElementById('topScorerGoals')) document.getElementById('topScorerGoals').textContent = topG.val+' Goals';
            // Placeholder Avatar using initials
            const initials = topG.name.split(' ').map(n=>n[0]).join('').substring(0,2);
            if(document.getElementById('topScorerAvatar')) document.getElementById('topScorerAvatar').innerText = initials;
        }

        const topA = Object.values(assists).sort((a,b)=>b.val-a.val)[0]; 
        if(topA) {
            if(document.getElementById('topAssist')) document.getElementById('topAssist').textContent = topA.name; 
            if(document.getElementById('topAssistCount')) document.getElementById('topAssistCount').textContent = topA.val+' Assists';
            const initials = topA.name.split(' ').map(n=>n[0]).join('').substring(0,2);
            if(document.getElementById('topAssistAvatar')) document.getElementById('topAssistAvatar').innerText = initials;
        }

        // Next Match Logic
        const upcomingSchedules = allData.filter(d => d.type === 'schedule' && new Date(d.date + 'T' + (d.time || '00:00')) > new Date())
                                         .sort((a,b) => new Date(a.date) - new Date(b.date));
        
        if (upcomingSchedules.length > 0) {
            const next = upcomingSchedules[0];
            if(document.getElementById('nextMatchTitle')) document.getElementById('nextMatchTitle').textContent = "vs " + next.name;
            const d = new Date(next.date);
            if(document.getElementById('nextMatchDate')) document.getElementById('nextMatchDate').textContent = d.toLocaleDateString('id-ID', {day:'numeric', month:'long'}) + ' @ ' + next.time;
            
            // Start Countdown
            if(countdownInterval) clearInterval(countdownInterval);
            const target = new Date(next.date + 'T' + next.time).getTime();
            
            countdownInterval = setInterval(() => {
                const now = new Date().getTime();
                const distance = target - now;
                
                if (distance < 0) {
                    clearInterval(countdownInterval);
                    if(document.getElementById('countdownDays')) document.getElementById('countdownDays').textContent = "0";
                    if(document.getElementById('countdownHours')) document.getElementById('countdownHours').textContent = "0";
                } else {
                    const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    if(document.getElementById('countdownDays')) document.getElementById('countdownDays').textContent = days;
                    if(document.getElementById('countdownHours')) document.getElementById('countdownHours').textContent = hours;
                }
            }, 1000);
        } else {
            if(document.getElementById('nextMatchTitle')) document.getElementById('nextMatchTitle').textContent = "Belum Ada Jadwal";
            if(document.getElementById('nextMatchDate')) document.getElementById('nextMatchDate').textContent = "-";
        }
    }

    // --- ISLAMI (API) & REVAMPED LOGIC ---
    async function getAutoPrayerTimes() {
      const date = new Date(); const d = String(date.getDate()).padStart(2,'0'); const m = String(date.getMonth()+1).padStart(2,'0'); const y = date.getFullYear();
      try { const res = await fetch(`https://api.aladhan.com/v1/timings/${d}-${m}-${y}?latitude=-6.9175&longitude=107.6191&method=20`); const json = await res.json(); const t = json.data.timings; return [{prayer:"Subuh",prayer_time:t.Fajr},{prayer:"Dzuhur",prayer_time:t.Dhuhr},{prayer:"Ashar",prayer_time:t.Asr},{prayer:"Maghrib",prayer_time:t.Maghrib},{prayer:"Isya",prayer_time:t.Isha}]; } catch(e){ return null; }
    }
    
    async function renderPrayerSchedule() {
      const container = document.getElementById('prayerSchedule');
      if(!container) return;
      container.innerHTML = '<p class="col-span-full text-center text-emerald-600 animate-pulse">Mengambil jadwal sholat...</p>';
      
      const data = await getAutoPrayerTimes() || [
          {prayer:"Subuh",prayer_time:"04:15"},
          {prayer:"Dzuhur",prayer_time:"11:50"},
          {prayer:"Ashar",prayer_time:"15:15"},
          {prayer:"Maghrib",prayer_time:"18:00"},
          {prayer:"Isya",prayer_time:"19:15"}
      ];
      
      container.innerHTML = data.map((p, idx) => {
          return `
          <div class="bg-white rounded-xl p-3 border border-emerald-100 shadow-sm text-center hover:shadow-md transition-all group">
             <div class="text-xs text-gray-400 uppercase tracking-wider mb-1 font-semibold">${p.prayer}</div>
             <div class="text-lg font-bold text-emerald-800 font-head group-hover:scale-110 transition-transform">${p.prayer_time}</div>
          </div>
          `;
      }).join('');
    }
    
    // --- API AYAT RANDOM ---
    async function getRandomAyat() {
        const totalAyat = 6236;
        const randomNum = Math.floor(Math.random() * totalAyat) + 1;
        
        const ayatEl = document.getElementById('ayatText');
        const transEl = document.getElementById('ayatTranslation');
        
        // Loading State
        if(ayatEl) ayatEl.innerHTML = '<span class="text-base text-gray-400 animate-pulse">Sedang mengambil ayat acak dari Al-Quran Cloud...</span>';
        if(transEl) transEl.innerText = '';

        try {
            const response = await fetch(`https://api.alquran.cloud/v1/ayah/${randomNum}/editions/quran-uthmani,id.indonesian`);
            const data = await response.json();
            
            if (data.code === 200 && ayatEl && transEl) {
                const arabicData = data.data[0];
                const indoData = data.data[1];
                
                ayatEl.innerText = arabicData.text;
                transEl.innerHTML = `"${indoData.text}" <br><br><b>(QS. ${arabicData.surah.englishName}: ${arabicData.numberInSurah})</b>`;
            }
        } catch (error) {
            console.error("Gagal mengambil ayat", error);
            if(ayatEl) ayatEl.innerText = "Fainna ma'al 'usri yusra";
            if(transEl) transEl.innerText = "Sesungguhnya bersama kesulitan ada kemudahan. (Mode Offline)";
        }
    }

    // --- NEW: API DOA ONLINE (FIXED QUOTES & ESCAPING) ---
    window.getOnlineDoa = async function() {
        const container = document.getElementById('doaListContainer');
        if(!container) return;
        
        container.innerHTML = '<div class="text-center py-4 text-gray-500 text-sm animate-pulse">Mengambil data doa online...</div>';
        
        try {
            const response = await fetch('https://open-api.my.id/api/doa');
            const data = await response.json();
            
            if(Array.isArray(data) && data.length > 0) {
                const shuffled = data.sort(() => 0.5 - Math.random());
                const selected = shuffled.slice(0, 5); 
                
                container.innerHTML = selected.map(d => {
                    // ESCAPE SINGLE QUOTES FOR ONCLICK
                    const safeJudul = d.judul.replace(/'/g, "\\'");
                    const safeArab = d.arab.replace(/'/g, "\\'");
                    const safeTerjemah = d.terjemah.replace(/'/g, "\\'");
                    
                    return `
                    <div class="p-3 bg-white border border-green-100 rounded-lg hover:shadow-md transition cursor-pointer group" onclick="showPrayer('${safeJudul}', '${safeArab}', '${safeTerjemah}')">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs group-hover:bg-emerald-600 group-hover:text-white transition">ğŸ¤²</div>
                            <div class="text-sm font-semibold text-gray-700 truncate">${d.judul}</div>
                        </div>
                    </div>
                    `;
                }).join('');
            } else {
                throw new Error("Data kosong");
            }
        } catch (e) {
            console.error(e);
            container.innerHTML = '<div class="text-center py-2 text-red-400 text-xs">Gagal memuat doa online. Coba lagi nanti.</div>';
        }
    }

    function displayRenungan() { refreshRenungan(); }
    
    window.refreshRenungan = function() { 
        const randomH = hadistDatabase[Math.floor(Math.random() * hadistDatabase.length)];
        const hEl = document.getElementById('hadistText');
        if(hEl) hEl.textContent = randomH;
        getRandomAyat();
    }

    // --- NEW: PRAYER MODAL LOGIC (UPDATED) ---
    window.showPrayer = function(title, arabic, translation) {
        document.getElementById('modalPrayerTitle').textContent = title;
        document.getElementById('modalPrayerArabic').textContent = arabic;
        document.getElementById('modalPrayerTrans').textContent = translation;
        document.getElementById('prayerModal').classList.remove('hidden');
    }
    window.closePrayerModal = function() {
        document.getElementById('prayerModal').classList.add('hidden');
    }
    
    // --- KAJIAN (REVAMPED LIST) ---
    window.addKajian = async function() { await createData({ type:'kajian', kajian_topic:document.getElementById('kajianTopic').value, kajian_date:document.getElementById('kajianDate').value, kajian_time:document.getElementById('kajianTime').value, kajian_speaker:document.getElementById('kajianSpeaker').value, createdAt: new Date().toISOString() }); showToast('Jadwal Kajian Disimpan'); }
    
    function renderKajianList() { 
        const listContainer = document.getElementById('kajianList');
        if (!listContainer) return;
        const items = allData.filter(d=>d.type==='kajian').sort((a,b)=>new Date(a.kajian_date)-new Date(b.kajian_date));
        
        if(items.length === 0) {
            listContainer.innerHTML = `<div class="p-6 text-center text-gray-400 italic bg-gray-50 rounded-xl border border-dashed border-gray-300">Belum ada agenda kajian dalam waktu dekat.</div>`;
            return;
        }

        listContainer.innerHTML = items.map(k=>`
            <div class="bg-white rounded-xl shadow-sm border border-l-4 border-l-amber-400 p-4 flex flex-col md:flex-row justify-between items-start md:items-center hover-lift relative overflow-hidden">
                <div class="flex-1">
                    <div class="flex items-center gap-2 mb-1">
                        <span class="bg-green-100 text-green-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase">Kajian Rutin</span>
                        <span class="text-xs text-gray-400 flex items-center gap-1">ğŸ“… ${new Date(k.kajian_date).toLocaleDateString('id-ID', {day:'numeric', month:'long'})} â€¢ â° ${k.kajian_time}</span>
                    </div>
                    <h4 class="text-lg font-bold text-slate-800">${k.kajian_topic}</h4>
                    <p class="text-sm text-gray-600 mt-1">ğŸ‘¤ Bersama: <span class="font-semibold text-amber-700">${k.kajian_speaker}</span></p>
                </div>
                <button onclick="deleteKajian('${k.__backendId}')" class="admin-only absolute top-2 right-2 text-red-400 hover:text-red-600 bg-white p-1 rounded-full shadow-sm">ğŸ—‘ï¸</button>
            </div>
        `).join(''); 
    }
    window.deleteKajian = async function(id) { if(confirm('Hapus?')) await deleteData(id); }

    // --- ANGGOTA (IMPORT/EXPORT FIXED) ---
    window.addMember = async function() { 
        const name = document.getElementById('memberName').value; 
        if(!name) return; 
        
        await createData({ 
            type:'member', 
            name, 
            position:document.getElementById('memberPosition').value, 
            phone:document.getElementById('memberPhone').value, 
            skill_level:document.getElementById('memberSkill').value, 
            availability:document.getElementById('memberAvailability').value,
            photo: document.getElementById('memberPhoto').value, 
            createdAt: new Date().toISOString() 
        }); 
        
        document.getElementById('memberName').value=''; 
        document.getElementById('memberPhoto').value=''; 
        showToast('Anggota ditambah'); 
    }
    
    function renderMembers() { 
        const container = document.getElementById('memberList');
        if (!container) return;
        const countEl = document.getElementById('totalPlayerCount');
        
        let members = allData.filter(d=>d.type==='member');
        
        // FILTER BY SEARCH
        if (searchQuery) {
            members = members.filter(m => m.name.toLowerCase().includes(searchQuery) || m.position.toLowerCase().includes(searchQuery));
        }

        if(countEl) countEl.innerText = `${members.length} Pemain Terdaftar`;
        
        if (members.length === 0) {
            container.innerHTML = `<div class="col-span-full text-center py-12 text-gray-400">Tidak ada pemain ditemukan.</div>`;
            return;
        }

        container.innerHTML = members.map(m => {
            let posColor = "bg-gray-500";
            let posGradient = "from-gray-700 to-gray-900";
            
            if (m.position === 'Kiper') { posColor = "bg-yellow-500"; posGradient = "from-yellow-600 to-yellow-800"; }
            else if (m.position === 'Bek') { posColor = "bg-blue-500"; posGradient = "from-blue-600 to-blue-800"; }
            else if (m.position === 'Gelandang') { posColor = "bg-emerald-500"; posGradient = "from-emerald-600 to-emerald-800"; }
            else if (m.position === 'Striker') { posColor = "bg-rose-500"; posGradient = "from-rose-600 to-rose-800"; }

            let stars = "â­";
            if (m.skill_level === 'Menengah') stars = "â­â­";
            if (m.skill_level === 'Mahir') stars = "â­â­â­";

            const pStats = allData.filter(d=>d.type==='stats' && d.member_id===m.__backendId);
            const caps = pStats.length;
            const goals = pStats.reduce((a,b)=>a+(parseInt(b.goals)||0),0);

            return `
            <div class="relative bg-gradient-to-b ${posGradient} rounded-2xl p-4 text-white shadow-xl hover-lift group overflow-hidden cursor-pointer border-2 border-white/20" onclick="showPlayerDetail('${m.__backendId}')">
                <div class="flex justify-between items-start mb-2 relative z-10">
                    <div class="text-center">
                        <div class="text-2xl font-bold font-head leading-none">${90 + (caps > 5 ? 5 : 0)}</div>
                        <div class="text-[10px] opacity-75 uppercase">OVR</div>
                    </div>
                    <div class="text-xs font-bold bg-white/20 backdrop-blur px-2 py-1 rounded uppercase">${m.position}</div>
                </div>
                
                <div class="w-24 h-24 mx-auto mb-2 relative z-10 rounded-full border-4 border-white/30 overflow-hidden bg-white/10 shadow-lg">
                    <img src="${m.photo || 'https://via.placeholder.com/150?text=' + m.name.charAt(0)}" 
                         class="w-full h-full object-cover" 
                         onerror="this.src='https://via.placeholder.com/150?text=Player'">
                </div>
                
                <div class="text-center relative z-10">
                    <h3 class="font-bold font-head text-xl leading-tight truncate px-2">${m.name}</h3>
                    <div class="text-xs text-white/70 mb-3">${stars} â€¢ ${m.availability}</div>
                    
                    <div class="grid grid-cols-3 gap-1 text-center bg-black/20 rounded-lg p-2 border border-white/10">
                        <div>
                            <div class="font-bold text-sm">${caps}</div>
                            <div class="text-[9px] uppercase opacity-60">Main</div>
                        </div>
                        <div>
                            <div class="font-bold text-sm">${goals}</div>
                            <div class="text-[9px] uppercase opacity-60">Gol</div>
                        </div>
                        <div>
                            <div class="font-bold text-sm">Active</div>
                            <div class="text-[9px] uppercase opacity-60">Status</div>
                        </div>
                    </div>
                </div>

                <div class="admin-only absolute top-2 right-2 z-20 hidden group-hover:flex gap-1">
                    <button onclick="event.stopPropagation();editMember('${m.__backendId}')" class="bg-white text-blue-600 p-1.5 rounded-full text-xs shadow hover:scale-110 transition">âœï¸</button>
                    <button onclick="event.stopPropagation();deleteMember('${m.__backendId}')" class="bg-white text-red-600 p-1.5 rounded-full text-xs shadow hover:scale-110 transition">ğŸ—‘ï¸</button>
                </div>
                
                <div class="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-20"></div>
                <div class="absolute -bottom-10 -right-10 text-9xl opacity-5 rotate-12 font-head pointer-events-none select-none">${m.position.substring(0,3)}</div>
            </div>
            `;
        }).join('');
    }
    
    window.exportMembersCSV = function() {
        const rows = [["Nama","Posisi","Telepon","Skill","Ketersediaan"]];
        allData.filter(d=>d.type==='member').forEach(m=>rows.push([`"${m.name}"`,m.position,`'${m.phone}`,m.skill_level,m.availability]));
        const csvContent = "data:text/csv;charset=utf-8," + rows.map(e => e.join(",")).join("\n");
        const link = document.createElement("a"); link.setAttribute("href", encodeURI(csvContent)); link.setAttribute("download", "anggota.csv"); document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }
    window.backupMembersJSON = function() {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(allData.filter(d=>d.type==='member')));
        const link = document.createElement("a"); link.setAttribute("href", dataStr); link.setAttribute("download", "backup_anggota.json"); document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }
    window.processImport = function(e) {
        const reader = new FileReader(); reader.onload = async function(evt) {
            const rows = evt.target.result.split('\n').slice(1);
            let count = 0;
            for(let row of rows) {
                const cols = row.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
                if(cols && cols.length >= 3) {
                    const name = cols[0].replace(/"/g,'');
                    if(!allData.find(d=>d.type==='member' && d.name===name)){
                        await createData({ type:'member', name, position:cols[1]||'Gelandang', phone:cols[2]?.replace(/'/g,'')||'-', skill_level:cols[3]||'Menengah', availability:cols[4]||'Fleksibel', createdAt: new Date().toISOString() });
                        count++;
                    }
                }
            }
            showToast(`Import ${count} data berhasil`);
        }; reader.readAsText(e.target.files[0]);
    }

    // --- OTHER MODAL LOGIC (Edit Member, etc) ---
    window.editMember = function(id) { 
        currentEditingRecord=allData.find(d=>d.__backendId===id); 
        if(!currentEditingRecord) return; 
        document.getElementById('editMemberName').value=currentEditingRecord.name; 
        document.getElementById('editMemberPosition').value=currentEditingRecord.position; 
        document.getElementById('editMemberPhone').value=currentEditingRecord.phone; 
        document.getElementById('editMemberSkill').value=currentEditingRecord.skill_level; 
        document.getElementById('editMemberAvailability').value=currentEditingRecord.availability; 
        document.getElementById('editMemberPhoto').value=currentEditingRecord.photo || ''; 
        document.getElementById('editMemberModal').classList.remove('hidden'); 
    }
    
    window.saveEditMember = async function() { 
        if(!currentEditingRecord) return; 
        await updateData({
            ...currentEditingRecord, 
            name:document.getElementById('editMemberName').value, 
            position:document.getElementById('editMemberPosition').value, 
            phone:document.getElementById('editMemberPhone').value, 
            skill_level:document.getElementById('editMemberSkill').value, 
            availability:document.getElementById('editMemberAvailability').value,
            photo: document.getElementById('editMemberPhoto').value 
        }); 
        showToast('Update berhasil'); closeEditMemberModal(); 
    }
    window.closeEditMemberModal = function() { document.getElementById('editMemberModal').classList.add('hidden'); }
    window.deleteMember = async function(id) { if(confirm('Hapus?')) await deleteData(id); }
    window.showPlayerDetail = function(id) { 
        document.getElementById('playerModal').classList.remove('hidden'); 
        const m = allData.find(d=>d.__backendId===id); 
        if(m) {
            document.getElementById('modalPlayerName').textContent=m.name; 
            document.getElementById('modalPlayerPos').textContent=m.position;
            
            const pStats = allData.filter(d=>d.type==='stats' && d.member_id===id);
            const totalGoals = pStats.reduce((a,b)=>a+(parseInt(b.goals)||0),0);
            const totalAssists = pStats.reduce((a,b)=>a+(parseInt(b.assists)||0),0);
            document.getElementById('modalStatsCaps').textContent = pStats.length;
            document.getElementById('modalStatsGoals').textContent = totalGoals;
            document.getElementById('modalStatsAssist').textContent = totalAssists;
            
            document.getElementById('modalHistoryList').innerHTML = pStats.map(s => 
                `<div class="flex justify-between border-b py-1"><span>${s.date}</span><span class="font-bold">${s.totalPoints} pts</span></div>`
            ).join('');
        }
    }
    window.closePlayerModal = function() { document.getElementById('playerModal').classList.add('hidden'); }

    // --- JADWAL & TEAMS ---
    window.addSchedule = async function() { await createData({ type:'schedule', schedule_type:document.getElementById('scheduleType').value, name:document.getElementById('scheduleName').value, date:document.getElementById('scheduleDate').value, time:document.getElementById('scheduleTime').value, location:document.getElementById('scheduleLocation').value, createdAt:new Date().toISOString() }); showToast('Jadwal disimpan'); }
    function renderSchedules() { 
        const list = document.getElementById('scheduleList');
        if (!list) return;
        
        let schedules = allData.filter(d=>d.type==='schedule');
        
        // Filter Search
        if (searchQuery) {
            schedules = schedules.filter(s => s.name.toLowerCase().includes(searchQuery) || s.location.toLowerCase().includes(searchQuery));
        }

        // Sort by Date (Nearest first)
        schedules.sort((a,b) => new Date(a.date + 'T' + (a.time || '00:00')) - new Date(b.date + 'T' + (b.time || '00:00')));

        if(schedules.length === 0) {
             list.innerHTML = `
             <div class="text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">
                <div class="text-4xl mb-2">ğŸ“…</div>
                <p class="text-gray-500 font-semibold">Belum ada agenda.</p>
                <p class="text-gray-400 text-sm">Istirahatlah sejenak, Baginda.</p>
             </div>
             `;
             return;
        }

        list.innerHTML = schedules.map(s => {
            // Date formatting
            const dateObj = new Date(s.date);
            const dayName = dateObj.toLocaleDateString('id-ID', { weekday: 'long' });
            const dayDate = dateObj.getDate();
            const monthName = dateObj.toLocaleDateString('id-ID', { month: 'short' });
            
            // Type Styling
            let typeBadge = '';
            let cardClass = '';
            let dateBoxColor = '';
            
            if(s.schedule_type === 'Friendly Match') {
                typeBadge = '<span class="bg-blue-100 text-blue-700 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider">Friendly Match</span>';
                cardClass = 'border-l-4 border-blue-500';
                dateBoxColor = 'bg-blue-50 text-blue-700';
            } else {
                typeBadge = '<span class="bg-green-100 text-green-700 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider">Fun Football</span>';
                cardClass = 'border-l-4 border-green-500';
                dateBoxColor = 'bg-green-50 text-green-700';
            }

            return `
            <div class="bg-white rounded-xl shadow-sm hover:shadow-md transition-all p-4 flex items-center gap-4 ${cardClass} relative group">
                <!-- Date Box -->
                <div class="flex-shrink-0 w-16 h-16 ${dateBoxColor} rounded-lg flex flex-col items-center justify-center border border-gray-100">
                    <span class="text-xs font-bold uppercase">${monthName}</span>
                    <span class="text-2xl font-bold font-head leading-none">${dayDate}</span>
                    <span class="text-[9px] uppercase opacity-70">${dayName.substring(0,3)}</span>
                </div>
                
                <!-- Info -->
                <div class="flex-1 min-w-0">
                    <div class="mb-1">${typeBadge}</div>
                    <h4 class="text-lg font-bold text-slate-800 truncate">${s.name}</h4>
                    <div class="flex items-center gap-3 text-sm text-gray-500 mt-1">
                        <span class="flex items-center gap-1">â° ${s.time} WIB</span>
                        <span class="flex items-center gap-1 truncate">ğŸ“ ${s.location}</span>
                    </div>
                </div>
                
                <!-- Action / Countdown Placeholder -->
                <div class="hidden sm:block text-right">
                    <button onclick="window.open('https://maps.google.com/?q=${s.location}', '_blank')" class="text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-1.5 rounded-full font-bold transition">
                        ğŸ—ºï¸ Peta
                    </button>
                </div>

                <!-- Admin Delete -->
                <button onclick="deleteSchedule('${s.__backendId}')" class="admin-only absolute top-2 right-2 bg-red-100 text-red-500 p-1.5 rounded-full hover:bg-red-200 transition opacity-0 group-hover:opacity-100">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
                </button>
            </div>
            `;
        }).join(''); 
    }
    window.deleteSchedule = async function(id) { if(confirm('Hapus?')) await deleteData(id); }
    
    // --- MATCH ---
    window.addMatch = async function() { await createData({ type:'match', opponent:document.getElementById('matchOpponent').value, date:document.getElementById('matchDate').value, location:document.getElementById('matchLocation').value, match_type:document.getElementById('matchType').value, score_us:document.getElementById('matchScoreUs').value, score_opponent:document.getElementById('matchScoreOpponent').value, result: (parseInt(document.getElementById('matchScoreUs').value) > parseInt(document.getElementById('matchScoreOpponent').value) ? 'Menang' : 'Kalah'), createdAt:new Date().toISOString() }); showToast('Match disimpan'); }
    function renderMatches() { 
        const list = document.getElementById('matchList');
        if (!list) return;
        let matches = allData.filter(d=>d.type==='match');
        
        if (searchQuery) {
            matches = matches.filter(m => m.opponent.toLowerCase().includes(searchQuery) || m.location.toLowerCase().includes(searchQuery));
        }

        list.innerHTML = matches.map(m=>`<div class="bg-white p-3 rounded shadow mb-2 border-l-4 border-purple-500"><div class="font-bold text-center">${m.score_us} - ${m.score_opponent}</div><div class="text-center text-xs text-gray-500">${m.match_type} vs ${m.opponent}</div><button onclick="inputStatsForMatch('${m.__backendId}')" class="w-full mt-2 bg-gray-100 text-xs py-1 rounded">Isi Statistik</button><button onclick="deleteMatch('${m.__backendId}')" class="admin-only text-red-500 text-xs float-right mt-1">Hapus</button></div>`).join(''); 
    }
    window.deleteMatch = async function(id) { if(confirm('Hapus?')) await deleteData(id); }

    // --- STATISTIK ---
    window.inputStatsForMatch = function(id) { showMenu('statistik'); const m=allData.find(d=>d.__backendId===id); if(m) document.getElementById('statsDate').value=m.date; }
    window.updatePlayerDropdown = function() { document.getElementById('statsPlayerName').innerHTML = '<option value="">Pilih</option>' + allData.filter(d=>d.type==='member').map(m=>`<option value="${m.__backendId}">${m.name}</option>`).join(''); }
    window.addStats = async function() {
        const pts = (parseInt(document.getElementById('statsGoals').value)||0)*3 + (parseInt(document.getElementById('statsAssists').value)||0) + (parseInt(document.getElementById('statsSaves').value)||0);
        await createData({ type:'stats', member_id:document.getElementById('statsPlayerName').value, date:document.getElementById('statsDate').value, goals:document.getElementById('statsGoals').value, assists:document.getElementById('statsAssists').value, saves:document.getElementById('statsSaves').value, totalPoints:pts, createdAt:new Date().toISOString() });
        showToast('Statistik disimpan');
    }
    function renderStats() { 
        const map = {}; 
        allData.filter(d=>d.type==='stats').forEach(s=>{ if(!map[s.member_id]) map[s.member_id]=0; map[s.member_id]+=parseInt(s.totalPoints); });
        const sorted = Object.keys(map).sort((a,b)=>map[b]-map[a]);
        document.getElementById('statsList').innerHTML = sorted.map((id,i)=>{ const m=allData.find(d=>d.__backendId===id); return m ? `<div class="flex justify-between p-2 border-b"><span>#${i+1} ${m.name}</span><span class="font-bold">${map[id]} pts</span></div>` : ''; }).join('');
    }

    // --- INVENTARIS (REVAMPED LOGIC WITH CARDS) ---
    window.addInventory = async function() { 
        await createData({ 
            type:'inventory', 
            item_name:document.getElementById('itemName').value, 
            item_image:document.getElementById('itemImage').value, 
            quantity:document.getElementById('itemQuantity').value, 
            condition:document.getElementById('itemCondition').value, 
            createdAt:new Date().toISOString() 
        }); 
        showToast('Item ditambah'); 
        document.getElementById('itemName').value='';
        document.getElementById('itemImage').value='';
        document.getElementById('itemQuantity').value='';
    }
    
    function renderInventory() { 
        const grid = document.getElementById('inventoryList');
        if(!grid) return;
        
        let items = allData.filter(d=>d.type==='inventory');
        
        if (searchQuery) {
            items = items.filter(i => i.item_name.toLowerCase().includes(searchQuery));
        }
        
        if(items.length === 0) {
            grid.innerHTML = `
            <div class="col-span-full text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">
                <div class="text-4xl mb-2">ğŸ“¦</div>
                <p class="text-gray-500 font-semibold">Tidak ada barang ditemukan.</p>
            </div>
            `;
            return;
        }

        grid.innerHTML = items.map(i => {
            let badgeColor = "bg-gray-100 text-gray-600";
            let conditionIcon = "â“";
            
            if (i.condition === 'Baik') {
                badgeColor = "bg-green-100 text-green-700 border-green-200";
                conditionIcon = "âœ…";
            } else if (i.condition === 'Cukup') {
                badgeColor = "bg-yellow-100 text-yellow-700 border-yellow-200";
                conditionIcon = "âš ï¸";
            } else if (i.condition === 'Perlu Diganti') {
                badgeColor = "bg-red-100 text-red-700 border-red-200";
                conditionIcon = "âŒ";
            }

            return `
            <div class="bg-white rounded-xl overflow-hidden shadow-sm hover-lift border border-gray-100 group relative flex flex-col">
                <div class="h-40 w-full bg-gray-100 relative overflow-hidden">
                    <img src="${i.item_image || 'https://via.placeholder.com/300x200?text=No+Image'}" 
                         class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
                         onerror="this.src='https://via.placeholder.com/300x200?text=Aset+Tim'">
                    
                    <div class="absolute top-2 left-2 ${badgeColor} text-[10px] font-bold px-2 py-1 rounded shadow-sm border">
                        ${conditionIcon} ${i.condition}
                    </div>
                </div>
                
                <div class="p-4 flex-1 flex flex-col justify-between">
                    <div>
                        <h4 class="font-bold text-slate-800 leading-tight mb-1 line-clamp-2">${i.item_name}</h4>
                        <div class="text-xs text-gray-500 font-mono bg-slate-50 inline-block px-2 py-1 rounded mt-1 border border-slate-100">
                            Stok: <span class="font-bold text-slate-800 text-sm">${i.quantity}</span> pcs
                        </div>
                    </div>
                    
                    <div class="admin-only mt-3 pt-3 border-t border-gray-100 flex gap-2">
                        <button onclick="editInventory('${i.__backendId}')" class="flex-1 bg-blue-50 text-blue-600 py-1.5 rounded text-xs font-bold hover:bg-blue-100 transition">Edit</button>
                        <button onclick="deleteInventory('${i.__backendId}')" class="flex-1 bg-red-50 text-red-600 py-1.5 rounded text-xs font-bold hover:bg-red-100 transition">Hapus</button>
                    </div>
                </div>
            </div>
            `;
        }).join(''); 
    }
    window.editInventory = function(id) { currentEditingRecord=allData.find(d=>d.__backendId===id); if(!currentEditingRecord) return; document.getElementById('editItemName').value=currentEditingRecord.item_name; document.getElementById('editItemImage').value=currentEditingRecord.item_image||''; document.getElementById('editItemQuantity').value=currentEditingRecord.quantity; document.getElementById('editItemCondition').value=currentEditingRecord.condition; document.getElementById('editInventoryModal').classList.remove('hidden'); }
    window.saveEditInventory = async function() { if(!currentEditingRecord) return; await updateData({...currentEditingRecord, item_name:document.getElementById('editItemName').value, item_image:document.getElementById('editItemImage').value, quantity:document.getElementById('editItemQuantity').value, condition:document.getElementById('editItemCondition').value }); showToast('Update berhasil'); closeEditInventoryModal(); }
    window.closeEditInventoryModal = function() { document.getElementById('editInventoryModal').classList.add('hidden'); }
    window.deleteInventory = async function(id) { if(confirm('Hapus?')) await deleteData(id); }

    // --- SPONSOR (REVAMPED LOGIC WITH UNIFIED DESIGN) ---
    window.addSponsor = async function() { 
        await createData({ 
            type:'sponsor', 
            sponsor_name:document.getElementById('sponsorName').value, 
            sponsor_image:document.getElementById('sponsorImage').value, 
            contact:document.getElementById('sponsorContact').value, 
            amount:document.getElementById('sponsorAmount').value,
            tier: document.getElementById('sponsorTier').value,
            createdAt:new Date().toISOString() 
        }); 
        showToast('Sponsor ditambah'); 
    }
    
    function renderSponsors() { 
        let list = allData.filter(d=>d.type==='sponsor');
        
        if (searchQuery) {
            list = list.filter(s => s.sponsor_name.toLowerCase().includes(searchQuery));
        }

        list = list.sort((a,b) => {
            const tierA = parseInt(a.tier) || 3;
            const tierB = parseInt(b.tier) || 3;
            if(tierA !== tierB) return tierA - tierB;
            return (parseInt(b.amount)||0) - (parseInt(a.amount)||0);
        });
        
        const grid = document.getElementById('sponsorListGrid');
        if(!grid) return;

        if(list.length === 0) {
            grid.innerHTML = `
            <div class="col-span-full text-center py-10 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200">
                <div class="text-4xl mb-2">ğŸ¤</div>
                <p class="text-gray-500 font-semibold">Tidak ada sponsor ditemukan.</p>
            </div>
            `;
            return;
        }

        grid.innerHTML = list.map((s) => {
            const tier = parseInt(s.tier) || 3;
            let tierClass = "";
            let badge = "";
            let textClass = "";
            let subTextClass = "";
            let borderImgClass = "";
            
            if (tier === 1) {
                tierClass = "bg-gradient-to-br from-slate-800 to-slate-900 border-slate-700 text-white shadow-lg";
                badge = `<div class="absolute top-0 left-0 bg-gradient-to-r from-amber-400 to-yellow-200 text-slate-900 text-[10px] font-bold px-3 py-1 rounded-br-lg shadow-sm z-10">ğŸ‘‘ PLATINUM</div>`;
                textClass = "text-white";
                subTextClass = "text-gray-400";
                borderImgClass = "border-amber-500/30";
            } else if (tier === 2) {
                tierClass = "bg-gradient-to-br from-amber-500 to-yellow-600 border-amber-400 text-white shadow-lg";
                badge = `<div class="absolute top-0 left-0 bg-white text-amber-600 text-[10px] font-bold px-3 py-1 rounded-br-lg shadow-sm z-10">â­ GOLD</div>`;
                textClass = "text-white";
                subTextClass = "text-amber-100";
                borderImgClass = "border-white/30";
            } else {
                tierClass = "bg-gradient-to-br from-slate-200 to-gray-300 border-gray-300 text-slate-800 shadow-md";
                badge = `<div class="absolute top-0 left-0 bg-slate-600 text-white text-[10px] font-bold px-3 py-1 rounded-br-lg shadow-sm z-10">ğŸ¥ˆ SILVER</div>`;
                textClass = "text-slate-900";
                subTextClass = "text-slate-600";
                borderImgClass = "border-slate-400/30";
            }

            return `
            <div class="${tierClass} relative rounded-2xl p-6 hover-lift group flex flex-col sm:flex-row items-center gap-6 min-h-[160px] overflow-hidden border">
                ${badge}
                
                <div class="absolute -bottom-6 -right-6 text-8xl opacity-10 ${textClass} rotate-12 font-head pointer-events-none select-none">${tier}</div>
                
                <div class="admin-only absolute top-2 right-2 flex gap-1 z-20 opacity-0 group-hover:opacity-100 transition-opacity">
                    <button onclick="editSponsor('${s.__backendId}')" class="bg-white/20 backdrop-blur text-current p-1 rounded hover:bg-white/40 text-xs">âœï¸</button>
                    <button onclick="deleteSponsor('${s.__backendId}')" class="bg-red-500/80 backdrop-blur text-white p-1 rounded hover:bg-red-600 text-xs">ğŸ—‘ï¸</button>
                </div>
                
                <div class="w-20 h-20 sm:w-24 sm:h-24 flex-shrink-0 relative flex items-center justify-center bg-white rounded-full p-2 shadow-xl border-4 ${borderImgClass}">
                        <img src="${s.sponsor_image || 'https://via.placeholder.com/100?text=' + s.sponsor_name.charAt(0)}" 
                            class="w-full h-full object-contain rounded-full" 
                            onerror="this.src='https://via.placeholder.com/100?text=Sponsor'">
                </div>
                
                <div class="text-center sm:text-left flex-1 relative z-10">
                    <h4 class="font-bold font-head text-2xl leading-tight mb-2 tracking-wide ${textClass}">${s.sponsor_name}</h4>
                    <p class="text-sm ${subTextClass} font-medium">${s.contact}</p>
                </div>
            </div>
            `;
        }).join('');
        
        // Add "Join Us" Card
        grid.innerHTML += `
        <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-2xl p-6 flex flex-col items-center justify-center text-center min-h-[160px] hover:bg-gray-100 transition cursor-pointer" onclick="showToast('Hubungi Admin untuk menjadi sponsor!')">
            <div class="text-4xl text-gray-300 mb-2 group-hover:scale-110 transition">+</div>
            <h4 class="font-bold text-gray-500">Slot Tersedia</h4>
            <p class="text-xs text-gray-400 mt-1">Jadilah bagian dari kami.</p>
        </div>
        `;
    }
    
    window.editSponsor = function(id) { 
        currentEditingRecord=allData.find(d=>d.__backendId===id); 
        if(!currentEditingRecord) return; 
        document.getElementById('editSponsorName').value=currentEditingRecord.sponsor_name; 
        document.getElementById('editSponsorImage').value=currentEditingRecord.sponsor_image||''; 
        document.getElementById('editSponsorContact').value=currentEditingRecord.contact; 
        document.getElementById('editSponsorAmount').value=currentEditingRecord.amount;
        document.getElementById('editSponsorTier').value=currentEditingRecord.tier || '3'; 
        document.getElementById('editSponsorModal').classList.remove('hidden'); 
    }
    
    window.saveEditSponsor = async function() { 
        if(!currentEditingRecord) return; 
        await updateData({
            ...currentEditingRecord, 
            sponsor_name:document.getElementById('editSponsorName').value, 
            sponsor_image:document.getElementById('editSponsorImage').value, 
            contact:document.getElementById('editSponsorContact').value, 
            amount:document.getElementById('editSponsorAmount').value,
            tier: document.getElementById('editSponsorTier').value 
        }); 
        showToast('Update berhasil'); closeEditSponsorModal(); 
    }
    window.closeEditSponsorModal = function() { document.getElementById('editSponsorModal').classList.add('hidden'); }
    window.deleteSponsor = async function(id) { if(confirm('Hapus?')) await deleteData(id); }
    window.handleManageSponsor = function() {
        if(document.body.classList.contains('is-admin')){
            document.getElementById('sponsorSectionAdmin').scrollIntoView({behavior: 'smooth'});
        } else {
            showToast('Silakan Login sebagai Admin', 'error');
            toggleAdmin();
        }
    }

    // --- SYSTEM ---
    window.showToast = function(msg, type='success') { const t = document.createElement('div'); t.className = `fixed top-4 right-4 z-[9999] px-4 py-2 rounded text-white shadow-lg toast ${type==='success'?'bg-green-500':'bg-red-500'}`; t.innerText = msg; document.body.appendChild(t); setTimeout(()=>t.remove(), 2800); }
    window.toggleAdmin = function() { 
        if(document.body.classList.contains('is-admin')){ 
            document.body.classList.remove('is-admin'); 
            document.getElementById('adminBtn').textContent='ğŸ”’'; 
            localStorage.setItem('isAdmin', 'false');
            showToast('Admin Logout'); 
        } else { 
            document.getElementById('loginModal').classList.remove('hidden'); 
        } 
    }
    window.submitLogin = function() { 
        if(document.getElementById('adminPassInput').value === 'hudan123'){ 
            document.body.classList.add('is-admin'); 
            document.getElementById('adminBtn').textContent='ğŸ”“'; 
            localStorage.setItem('isAdmin', 'true');
            closeAdminModal(); 
            showToast('Admin Login Success'); 
        } else { 
            showToast('Password Salah','error'); 
        } 
    }
    window.closeAdminModal = function() { document.getElementById('loginModal').classList.add('hidden'); }

    // Init Logic
    initializeAppUI();

  </script>
 </body>
</html>
